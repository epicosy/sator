from typing import List
from abc import ABC, abstractmethod

from sator.core.models.product import AffectedProducts
from sator.core.models.vulnerability.locator import VulnerabilityLocator
from sator.core.models.vulnerability.metadata import VulnerabilityMetadata
from sator.core.models.vulnerability.description import VulnerabilityDescription


class VulnerabilityResolutionPort(ABC):
    @abstractmethod
    def get_metadata(self, vulnerability_id: str) -> VulnerabilityMetadata | None:
        """Method for getting a vulnerability by its ID."""
        raise NotImplementedError

    @abstractmethod
    def get_description(self, vulnerability_id: str) -> VulnerabilityDescription | None:
        """Method for getting a vulnerability description by its ID."""
        raise NotImplementedError

    @abstractmethod
    def get_affected_products(self, vulnerability_id: str) -> AffectedProducts | None:
        """Method for getting all affected products by a vulnerability ID."""
        raise NotImplementedError

    @abstractmethod
    def get_locator(self, vulnerability_id: str) -> List[VulnerabilityLocator]:
        """Method for getting all locators by a vulnerability ID."""
        raise NotImplementedError
