from typing import Dict, List
from abc import ABC, abstractmethod

from sator.core.models.product import AffectedProducts
from sator.core.models.vulnerability import Vulnerability
from sator.core.models.vulnerability.locator import VulnerabilityLocator


class VulnerabilityResolutionPort(ABC):
    @abstractmethod
    def get_vulnerability(self, vulnerability_id: str) -> Vulnerability | None:
        """Method for getting a vulnerability by its ID."""
        raise NotImplementedError

    @abstractmethod
    def get_vulnerabilities(self) -> Dict[str, Vulnerability]:
        """Method for getting all vulnerabilities."""
        raise NotImplementedError

    @abstractmethod
    def get_affected_products(self, vulnerability_id: str) -> AffectedProducts | None:
        """Method for getting all affected products by a vulnerability ID."""
        raise NotImplementedError

    @abstractmethod
    def get_locator(self, vulnerability_id: str) -> List[VulnerabilityLocator]:
        """Method for getting all locators by a vulnerability ID."""
        raise NotImplementedError
